{% load static %}
<aside class="sidebar">
    <button type="button" class="sidebar-close-btn">
        <iconify-icon icon="radix-icons:cross-2"></iconify-icon>
    </button>
    <div>
        <a href="{% url 'index' %}" class="sidebar-logo">
            <img src="{% static 'images/logo.png' %}" alt="site logo" class="light-logo">
            <img src="{% static 'images/logo.png' %}" alt="site logo" class="dark-logo">
            <!-- Usar el mismo icono que el favicon / cabecera para el estado colapsado -->
            <img src="{% static 'images/home-eight/icono (144 x 144 px).png' %}" alt="site logo" class="logo-icon">
        </a>
    </div>
    <div class="sidebar-menu-area">
        <ul class="sidebar-menu" id="sidebar-menu">
            {% with rol=user.usuarioperfiloptimizador.rol %}
            {% if rol == 'operador' %}
              <!-- Menú exclusivo para Operador: solo sus proyectos, historial y salir -->
              <li>
                  <a href="{% url 'operador_home' %}">
                      <iconify-icon icon="solar:scissors-outline" class="menu-icon"></iconify-icon>
                      <span>Mis Proyectos</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'operador_historial' %}">
                      <iconify-icon icon="mdi:history" class="menu-icon"></iconify-icon>
                      <span>Historial</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'logout' %}">
                      <iconify-icon icon="solar:logout-2-outline" class="menu-icon"></iconify-icon>
                      <span>Cerrar Sesión</span>
                  </a>
              </li>
            {% else %}
              <!-- Menú completo para otros roles -->
              <li>
                  <a href="{% url 'index' %}">
                      <iconify-icon icon="solar:home-smile-angle-outline" class="menu-icon"></iconify-icon>
                      <span>Panel</span>
                  </a>
              </li>
              {% if user.is_superuser or user.usuarioperfiloptimizador.rol == 'super_admin' or user.usuarioperfiloptimizador.organizacion.is_general %}
              <li>
                  <a href="{% url 'chat' %}">
                      <iconify-icon icon="bi:chat-dots" class="menu-icon"></iconify-icon>
                      <span>Chat</span>
                  </a>
              </li>
              {% else %}
              <li>
                  <a href="javascript:void(0)" class="disabled-link" title="En desarrollo">
                      <iconify-icon icon="bi:chat-dots" class="menu-icon"></iconify-icon>
                      <span>Chat (En desarrollo)</span>
                  </a>
              </li>
              {% endif %}
              <li>
                  <a href="{% url 'proyectos' %}">
                      <iconify-icon icon="hugeicons:invoice-03" class="menu-icon"></iconify-icon>
                      <span>Proyectos</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'calendar' %}">
                      <iconify-icon icon="solar:calendar-outline" class="menu-icon"></iconify-icon>
                      <span>Calendario</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'usersList' %}">
                      <iconify-icon icon="solar:users-group-two-rounded-outline" class="menu-icon"></iconify-icon>
                      <span>Usuarios</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'optimizador_home' %}">
                      <iconify-icon icon="solar:widget-2-outline" class="menu-icon"></iconify-icon>
                      <span>Optimizador</span>
                  </a>
              </li>
              {% if user.is_superuser or user.usuarioperfiloptimizador.rol == 'super_admin' or user.usuarioperfiloptimizador.rol == 'org_admin' %}
              <li>
                  <a href="{% url 'configurador_3d' %}">
                      <iconify-icon icon="mdi:cube-outline" class="menu-icon"></iconify-icon>
                      <span>Configurador 3D</span>
                  </a>
              </li>
              {% endif %}
              <li>
                  <a href="{% url 'clientes_lista' %}">
                      <iconify-icon icon="solar:users-group-rounded-outline" class="menu-icon"></iconify-icon>
                      <span>Clientes</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'organizaciones_lista' %}">
                      <iconify-icon icon="solar:buildings-outline" class="menu-icon"></iconify-icon>
                      <span>Organizaciones</span>
                  </a>
              </li>
              <li class="dropdown">
                  <a href="javascript:void(0)" class="has-arrow">
                      <iconify-icon icon="solar:widget-4-outline" class="menu-icon"></iconify-icon>
                      <span>Materiales</span>
                  </a>
                  <ul class="sidebar-submenu">
                      <li><a href="{% url 'tableros' %}"><i class="ri-circle-fill circle-icon text-primary-600 w-auto"></i> Tableros</a></li>
                      <li><a href="{% url 'tapacantos' %}"><i class="ri-circle-fill circle-icon text-warning-main w-auto"></i> Tapacantos</a></li>
                  </ul>
              </li>
              <li>
                  <a href="{% url 'faqs' %}">
                      <iconify-icon icon="solar:question-circle-outline" class="menu-icon"></iconify-icon>
                      <span>Preguntas frecuentes</span>
                  </a>
              </li>
              <li>
                  <a href="{% url 'logout' %}">
                      <iconify-icon icon="solar:logout-2-outline" class="menu-icon"></iconify-icon>
                      <span>Cerrar Sesión</span>
                  </a>
              </li>
            {% endif %}
            {% endwith %}
        </ul>
    </div>
</aside>